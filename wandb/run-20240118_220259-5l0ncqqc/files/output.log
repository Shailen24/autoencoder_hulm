  0%|                                                                                                                                                                                                                 | 0/50 [00:00<?, ?it/s]You're using a RobertaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
[33m[W 2024-01-18 22:03:00,717][39m Trial 0 failed with parameters: {'learning_rate': 5.3091682078847e-05} because of the following error: RuntimeError('The expanded size of the tensor (3469) must match the existing size (514) at non-singleton dimension 1.  Target sizes: [1, 3469].  Tensor sizes: [1, 514]').
Traceback (most recent call last):
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/integrations/integration_utils.py", line 199, in _objective
    trainer.train(resume_from_checkpoint=checkpoint, trial=trial)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 1537, in train
    return inner_training_loop(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 1854, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 2735, in training_step
    loss = self.compute_loss(model, inputs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 2758, in compute_loss
    outputs = model(**inputs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/models/roberta/modeling_roberta.py", line 1085, in forward
    outputs = self.roberta(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/models/roberta/modeling_roberta.py", line 802, in forward
    buffered_token_type_ids_expanded = buffered_token_type_ids.expand(batch_size, seq_length)
RuntimeError: The expanded size of the tensor (3469) must match the existing size (514) at non-singleton dimension 1.  Target sizes: [1, 3469].  Tensor sizes: [1, 514]
[33m[W 2024-01-18 22:03:00,788][39m Trial 0 failed with value None.
Traceback (most recent call last):
  File "trials.py", line 219, in <module>
    run_trials(data_path=data_paths[i],
  File "trials.py", line 177, in run_trials
    best_trial = trainer.hyperparameter_search(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 2633, in hyperparameter_search
    best_run = backend_obj.run(self, n_trials, direction, **kwargs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/hyperparameter_search.py", line 72, in run
    return run_hp_search_optuna(trainer, n_trials, direction, **kwargs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/integrations/integration_utils.py", line 211, in run_hp_search_optuna
    study.optimize(_objective, n_trials=n_trials, timeout=timeout, n_jobs=n_jobs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/study.py", line 451, in optimize
    _optimize(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/_optimize.py", line 66, in _optimize
    _optimize_sequential(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/_optimize.py", line 163, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/_optimize.py", line 251, in _run_trial
    raise func_err
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/integrations/integration_utils.py", line 199, in _objective
    trainer.train(resume_from_checkpoint=checkpoint, trial=trial)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 1537, in train
    return inner_training_loop(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 1854, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 2735, in training_step
    loss = self.compute_loss(model, inputs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 2758, in compute_loss
    outputs = model(**inputs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/models/roberta/modeling_roberta.py", line 1085, in forward
    outputs = self.roberta(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/models/roberta/modeling_roberta.py", line 802, in forward
    buffered_token_type_ids_expanded = buffered_token_type_ids.expand(batch_size, seq_length)
RuntimeError: The expanded size of the tensor (3469) must match the existing size (514) at non-singleton dimension 1.  Target sizes: [1, 3469].  Tensor sizes: [1, 514]
Traceback (most recent call last):
  File "trials.py", line 219, in <module>
    run_trials(data_path=data_paths[i],
  File "trials.py", line 177, in run_trials
    best_trial = trainer.hyperparameter_search(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 2633, in hyperparameter_search
    best_run = backend_obj.run(self, n_trials, direction, **kwargs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/hyperparameter_search.py", line 72, in run
    return run_hp_search_optuna(trainer, n_trials, direction, **kwargs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/integrations/integration_utils.py", line 211, in run_hp_search_optuna
    study.optimize(_objective, n_trials=n_trials, timeout=timeout, n_jobs=n_jobs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/study.py", line 451, in optimize
    _optimize(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/_optimize.py", line 66, in _optimize
    _optimize_sequential(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/_optimize.py", line 163, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/_optimize.py", line 251, in _run_trial
    raise func_err
  File "/chronos_data/ssmith/lib/python3.8/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/integrations/integration_utils.py", line 199, in _objective
    trainer.train(resume_from_checkpoint=checkpoint, trial=trial)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 1537, in train
    return inner_training_loop(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 1854, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 2735, in training_step
    loss = self.compute_loss(model, inputs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/trainer.py", line 2758, in compute_loss
    outputs = model(**inputs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/models/roberta/modeling_roberta.py", line 1085, in forward
    outputs = self.roberta(
  File "/chronos_data/ssmith/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/chronos_data/ssmith/lib/python3.8/site-packages/transformers/models/roberta/modeling_roberta.py", line 802, in forward
    buffered_token_type_ids_expanded = buffered_token_type_ids.expand(batch_size, seq_length)
RuntimeError: The expanded size of the tensor (3469) must match the existing size (514) at non-singleton dimension 1.  Target sizes: [1, 3469].  Tensor sizes: [1, 514]