









100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [01:05<00:00,  2.79it/s]



 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                            | 6/7 [00:03<00:00,  1.34it/s]
{'eval_loss': 6.09489631652832, 'eval_runtime': 6.3469, 'eval_samples_per_second': 7.878, 'eval_steps_per_second': 1.103, 'epoch': 1.0}
There were missing keys in the checkpoint model loaded: ['lm_head.decoder.weight', 'lm_head.decoder.bias'].
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [01:15<00:00,  1.51s/it]
[32m[I 2024-01-19 15:08:28,318][39m Trial 2 finished with value: 6.09489631652832 and parameters: {'learning_rate': 7.805237336904313e-05}. Best is trial 2 with value: 6.09489631652832.
{'eval_loss': 6.09489631652832, 'eval_runtime': 6.3469, 'eval_samples_per_second': 7.878, 'eval_steps_per_second': 1.103, 'epoch': 1.0, 'perplexity': 443.5880500436756, 'trial_params': '{"learning_rate": 7.805237336904313e-05}'} /cronus_data/ssmith/models/blogsUD/optuna_wandb_test/run-2
{'train_runtime': 81.318, 'train_samples_per_second': 0.615, 'train_steps_per_second': 0.615, 'train_loss': 6.352305908203125, 'epoch': 1.0}
pos embds stdev:  tensor(0.0662, grad_fn=<StdBackward0>)